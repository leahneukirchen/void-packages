# Template file for 'dtrace-utils'
pkgname=dtrace-utils
version=2.0.1.1.9999
revision=1
#archs="i686 x86_64"
#build_wrksrc=
build_style=gnu-configure
#configure_args="HAVE_BPFMASM=no"
make_build_args="-k"
#make_install_args=""
#conf_files=""
#make_dirs="/var/log/dir 0755 root root"
hostmakedepends="clang flex libgomp-devel pkg-config shadow lld
 cross-bpf-gcc cross-bpf-binutils"
makedepends="binutils-devel elfutils-devel fuse-devel libpcap-devel libpfm4-devel valgrind-devel libbpf-devel"
depends=""
short_desc="Linux version of the DTrace tracing tool"
maintainer="Leah Neukirchen <leah@vuxu.org>"
license="UPL-1.0"
homepage="https://github.com/oracle/dtrace-utils"
#changelog=""
#distfiles="https://github.com/oracle/dtrace-utils/archive/refs/tags/${version}.tar.gz"
distfiles="https://github.com/oracle/dtrace-utils/archive/refs/heads/devel.tar.gz"
checksum=33fa9b34510358e59e6d971cf6dab38300f5c7783f14046d6000beb5f3975cb6
nostrip_files="bpf_dlib.o"

export BPFC="bpf-gcc"
export BPFLD="bpf-ld"

post_install() {
	rm ${DESTDIR}/usr/share/doc/dtrace-2.0.1/showUSDT
	mv ${DESTDIR}/lib64/* ${DESTDIR}/usr/lib/
	rmdir ${DESTDIR}/lib64
}
